/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.5/samples
 */


plugins {
  id 'java'
  id 'eclipse'
  id("application")
}

tasks.register('Lukes'){
  doLast {
    println 'printing this line is the only thing Lukes secret task does'
  }
}

tasks.register('loadfile') {
  doLast {
    def file = file('./code')
    ant.loadfile(srcFile: file, property: file.name)
    println " *** $file.name ***"
    println "${ant.properties[file.name]}"
  }
}

repositories {
  mavenCentral()
}


dependencies {
  implementation("com.slack.api:bolt:1.24.0")
  implementation("com.slack.api:bolt-servlet:1.24.0")
  implementation("com.slack.api:bolt-jetty:1.24.0")
  implementation("org.slf4j:slf4j-simple:1.7.36")
}

application {
  mainClassName = "MainClass"
}


run {
  // gradle run -DslackLogLevel=debug
  systemProperty "org.slf4j.simpleLogger.log.com.slack.api", System.getProperty("slackLogLevel")

  def token = file('./SLACK_BOT_TOKEN')
  def secret = file('./SLACK_SIGNING_SECRET')

  ant.loadfile(srcFile: token, property: token.name)
  ant.loadfile(srcFile: secret, property: secret.name)

//  def tokenString = "${ant.properties[token.name]}".toString()
//  def secretString = "${ant.properties[secret.name]}".toString()

//  println(tokenString.endsWith('\n'))
  
  environment 'SLACK_BOT_TOKEN', "${ant.properties[token.name]}".minus('\n')
  environment 'SLACK_SIGNING_SECRET', "${ant.properties[secret.name]}".minus('\n')

}



